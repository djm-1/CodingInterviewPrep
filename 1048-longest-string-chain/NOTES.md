Constraints are difficult.
Write pre and comp function properly.